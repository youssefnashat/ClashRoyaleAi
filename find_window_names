import win32gui

def list_window_names():
    def winEnumHandler(hwnd, ctx):
        if win32gui.IsWindowVisible(hwnd):
            print(hex(hwnd), win32gui.GetWindowText(hwnd))
    
    win32gui.EnumWindows(winEnumHandler, None)

if __name__ == "__main__":
    print("Printing all visible window titles...")
    print("-" * 30)
    list_window_names()
    print("-" * 30)